-- Create the Snowpipe for VOC_ASMNT_SLS_RLNG_3_MNTH_SG table
CREATE OR REPLACE PIPE VOC_ASMNT_SLS_RLNG_3_MNTH_SG_PIPE
AUTO_INGEST = TRUE
AS
COPY INTO VOC_ASMNT_SLS_RLNG_3_MNTH_SG
(   
    FSCL_YR_NB,
    FSCL_RLNG_03_MNTH_NB,
    MTRX_CD,
    DLR_CD,
    DLR_NM,
    DLR_GRP_NM,
    DLR_ZN_NM,
    DOM_NM,
    ROM_NM,
    TOTL_RCVD_RCRD_NB,
    NO_CNTCT_NB,
    YES_CNTCT_NB,
    CLN_RCRD_ERR_NB,
    BNCE_NB,
    SCSS_SNT_NB,
    SNT_WHATSAPP_NB,
    SNT_EML_NB,
    CMPLTD_NB,
    SRVY_CMPLTD_WHATSAPP_NB,
    SRVY_CMPLTD_EML_NB,
    RSPNS_RT_TOTL_RCRD_PC,
    RSPNS_RT_SCSS_SNT_PC,
    CBD_PC,
    DLR_RNKG_NB,
    SCOR_0_VOC1_STSFCN_PRCHS_EXPRNC_NB,
    SCOR_1_VOC1_STSFCN_PRCHS_EXPRNC_NB,
    SCOR_2_VOC1_STSFCN_PRCHS_EXPRNC_NB,
    SCOR_3_VOC1_STSFCN_PRCHS_EXPRNC_NB,
    SCOR_4_VOC1_STSFCN_PRCHS_EXPRNC_NB,
    SCOR_5_VOC1_STSFCN_PRCHS_EXPRNC_NB,
    SCOR_6_VOC1_STSFCN_PRCHS_EXPRNC_NB,
    SCOR_7_VOC1_STSFCN_PRCHS_EXPRNC_NB,
    SCOR_8_VOC1_STSFCN_PRCHS_EXPRNC_NB,
    SCOR_9_VOC1_STSFCN_PRCHS_EXPRNC_NB,
    SCOR_10_VOC1_STSFCN_PRCHS_EXPRNC_NB,
    DETRACTOR_0_6_VOC1_STSFCN_PRCHS_EXPRNC_NB,
    NEUTRAL_7_8_VOC1_STSFCN_PRCHS_EXPRNC_NB,
    PROMOTER_9_10_VOC1_STSFCN_PRCHS_EXPRNC_NB,
    TOTL_VOC1_STSFCN_PRCHS_EXPRNC_NB,
    STSFCN_PRCHS_EXPRNC_NPS_PC,
    YES_VOC2_RTRN_FOR_NEW_PRCHS_OR_SVC_NB,
    NO_VOC2_RTRN_FOR_NEW_PRCHS_OR_SVC_NB,
    TOTL_VOC2_RTRN_FOR_NEW_PRCHS_OR_SVC_NB,
    SCOR_0_NPS1_RCMDTN_NB,
    SCOR_1_NPS1_RCMDTN_NB,
    SCOR_2_NPS1_RCMDTN_NB,
    SCOR_3_NPS1_RCMDTN_NB,
    SCOR_4_NPS1_RCMDTN_NB,
    SCOR_5_NPS1_RCMDTN_NB,
    SCOR_6_NPS1_RCMDTN_NB,
    SCOR_7_NPS1_RCMDTN_NB,
    SCOR_8_NPS1_RCMDTN_NB,
    SCOR_9_NPS1_RCMDTN_NB,
    SCOR_10_NPS1_RCMDTN_NB,
    DETRACTOR_0_6_NPS1_RCMDTN_NB,
    NEUTRAL_7_8_NPS1_RCMDTN_NB,
    PROMOTER_9_10_NPS1_RCMDTN_NB,
    NPS_RCMDTN_PC,
    NPS_AVRG_RCMDTN_NB,
    YES_VOC3_OFFERED_TST_DRV_NB,
    NO_VOC3_OFFERED_TST_DRV_NB,
    TOTL_VOC3_OFFERED_TST_DRV_NB,
    SCOR_0_VOC4_STSFCN_TST_DRV_NB,
    SCOR_1_VOC4_STSFCN_TST_DRV_NB,
    SCOR_2_VOC4_STSFCN_TST_DRV_NB,
    SCOR_3_VOC4_STSFCN_TST_DRV_NB,
    SCOR_4_VOC4_STSFCN_TST_DRV_NB,
    SCOR_5_VOC4_STSFCN_TST_DRV_NB,
    SCOR_6_VOC4_STSFCN_TST_DRV_NB,
    SCOR_7_VOC4_STSFCN_TST_DRV_NB,
    SCOR_8_VOC4_STSFCN_TST_DRV_NB,
    SCOR_9_VOC4_STSFCN_TST_DRV_NB,
    SCOR_10_VOC4_STSFCN_TST_DRV_NB,
    DETRACTOR_0_6_VOC4_STSFCN_TST_DRV_NB,
    NEUTRAL_7_8_VOC4_STSFCN_TST_DRV_NB,
    PROMOTER_9_10_VOC4_STSFCN_TST_DRV_NB,
    TST_DRV_NPS_PC,
    TST_DRV_AVRG_NB,
    SCOR_0_VOC5_EXPCTD_PRCHS_PRCS_NB,
    SCOR_1_VOC5_EXPCTD_PRCHS_PRCS_NB,
    SCOR_2_VOC5_EXPCTD_PRCHS_PRCS_NB,
    SCOR_3_VOC5_EXPCTD_PRCHS_PRCS_NB,
    SCOR_4_VOC5_EXPCTD_PRCHS_PRCS_NB,
    SCOR_5_VOC5_EXPCTD_PRCHS_PRCS_NB,
    SCOR_6_VOC5_EXPCTD_PRCHS_PRCS_NB,
    SCOR_7_VOC5_EXPCTD_PRCHS_PRCS_NB,
    SCOR_8_VOC5_EXPCTD_PRCHS_PRCS_NB,
    SCOR_9_VOC5_EXPCTD_PRCHS_PRCS_NB,
    SCOR_10_VOC5_EXPCTD_PRCHS_PRCS_NB,
    DETRACTOR_0_6_VOC5_EXPCTD_PRCHS_PRCS_NB,
    NEUTRAL_7_8_VOC5_EXPCTD_PRCHS_PRCS_NB,
    PROMOTER_9_10_VOC5_EXPCTD_PRCHS_PRCS_NB,
    PRCHS_PRCS_EXPCTD_NPS_PC,
    PRCHS_PRCS_EXPCTD_AVRG_NB,
    LVL_1_CLSD_TICKETS_NB,
    LVL_2_CLSD_TICKETS_NB,
    LVL_3_CLSD_TICKETS_NB,
    TOTL_CLSD_TICKETS_NB,
    LVL_1_PC_CLSD_TICKETS_PC,
    TCKT_OPN_NB,
    NPS_3RM_STSFCN_PRCHS_EXPRNC_CFCNT_PC,
    DETRACTOR_0_6_3RM_STSFCN_PRCHS_EXPRNC_CFCNT_NB,
    NEUTRAL_7_8_3RM_STSFCN_PRCHS_EXPRNC_CFCNT_NB,
    PROMOTER_9_10_3RM_STSFCN_PRCHS_EXPRNC_CFCNT_NB,
    NPS_6RM_STSFCN_PRCHS_EXPRNC_CFCNT_PC,
    DETRACTOR_0_6_6RM_STSFCN_PRCHS_EXPRNC_CFCNT_NB,
    NEUTRAL_7_8_6RM_STSFCN_PRCHS_EXPRNC_CFCNT_NB,
    PROMOTER_9_10_6RM_STSFCN_PRCHS_EXPRNC_CFCNT_NB,
    CFCNT_3RM_STSFCN_PRCHS_EXPRNC_CFCNT_PC,
    CFCNT_6RM_STSFCN_PRCHS_EXPRNC_CFCNT_PC,
    HASHKEY,
    AUDIT_LOADED_DATE)
FROM (   
    SELECT
        $1::FLOAT AS FSCL_YR_NB,
        $2::FLOAT AS FSCL_RLNG_03_MNTH_NB,
        $3::VARCHAR(250) AS MTRX_CD,
        $4::VARCHAR(250) AS DLR_CD,
        $5::VARCHAR(250) AS DLR_NM,
        $6::VARCHAR(250) AS DLR_GRP_NM,
        $7::VARCHAR(250) AS DLR_ZN_NM,
        $8::VARCHAR(250) AS DOM_NM,
        $9::VARCHAR(250) AS ROM_NM,
        $10::FLOAT AS TOTL_RCVD_RCRD_NB,
        $11::FLOAT AS NO_CNTCT_NB,
        $12::FLOAT AS YES_CNTCT_NB,
        $13::FLOAT AS CLN_RCRD_ERR_NB,
        $14::FLOAT AS BNCE_NB,
        $15::FLOAT AS SCSS_SNT_NB,
        $16::FLOAT AS SNT_WHATSAPP_NB,
        $17::FLOAT AS SNT_EML_NB,
        $18::FLOAT AS CMPLTD_NB,
        $19::FLOAT AS SRVY_CMPLTD_WHATSAPP_NB,
        $20::FLOAT AS SRVY_CMPLTD_EML_NB,
        $21::FLOAT AS RSPNS_RT_TOTL_RCRD_PC,
        $22::FLOAT AS RSPNS_RT_SCSS_SNT_PC,
        $23::FLOAT AS CBD_PC,
        $24::FLOAT AS DLR_RNKG_NB,
        $25::FLOAT AS SCOR_0_VOC1_STSFCN_PRCHS_EXPRNC_NB,
        $26::FLOAT AS SCOR_1_VOC1_STSFCN_PRCHS_EXPRNC_NB,
        $27::FLOAT AS SCOR_2_VOC1_STSFCN_PRCHS_EXPRNC_NB,
        $28::FLOAT AS SCOR_3_VOC1_STSFCN_PRCHS_EXPRNC_NB,
        $29::FLOAT AS SCOR_4_VOC1_STSFCN_PRCHS_EXPRNC_NB,
        $30::FLOAT AS SCOR_5_VOC1_STSFCN_PRCHS_EXPRNC_NB,
        $31::FLOAT AS SCOR_6_VOC1_STSFCN_PRCHS_EXPRNC_NB,
        $32::FLOAT AS SCOR_7_VOC1_STSFCN_PRCHS_EXPRNC_NB,
        $33::FLOAT AS SCOR_8_VOC1_STSFCN_PRCHS_EXPRNC_NB,
        $34::FLOAT AS SCOR_9_VOC1_STSFCN_PRCHS_EXPRNC_NB,
        $35::FLOAT AS SCOR_10_VOC1_STSFCN_PRCHS_EXPRNC_NB,
        $36::FLOAT AS DETRACTOR_0_6_VOC1_STSFCN_PRCHS_EXPRNC_NB,
        $37::FLOAT AS NEUTRAL_7_8_VOC1_STSFCN_PRCHS_EXPRNC_NB,
        $38::FLOAT AS PROMOTER_9_10_VOC1_STSFCN_PRCHS_EXPRNC_NB,
        $39::FLOAT AS TOTL_VOC1_STSFCN_PRCHS_EXPRNC_NB,
        $40::FLOAT AS STSFCN_PRCHS_EXPRNC_NPS_PC,
        $41::FLOAT AS YES_VOC2_RTRN_FOR_NEW_PRCHS_OR_SVC_NB,
        $42::FLOAT AS NO_VOC2_RTRN_FOR_NEW_PRCHS_OR_SVC_NB,
        $43::FLOAT AS TOTL_VOC2_RTRN_FOR_NEW_PRCHS_OR_SVC_NB,
        $44::FLOAT AS SCOR_0_NPS1_RCMDTN_NB,
        $45::FLOAT AS SCOR_1_NPS1_RCMDTN_NB,
        $46::FLOAT AS SCOR_2_NPS1_RCMDTN_NB,
        $47::FLOAT AS SCOR_3_NPS1_RCMDTN_NB,
        $48::FLOAT AS SCOR_4_NPS1_RCMDTN_NB,
        $49::FLOAT AS SCOR_5_NPS1_RCMDTN_NB,
        $50::FLOAT AS SCOR_6_NPS1_RCMDTN_NB,
        $51::FLOAT AS SCOR_7_NPS1_RCMDTN_NB,
        $52::FLOAT AS SCOR_8_NPS1_RCMDTN_NB,
        $53::FLOAT AS SCOR_9_NPS1_RCMDTN_NB,
        $54::FLOAT AS SCOR_10_NPS1_RCMDTN_NB,
        $55::FLOAT AS DETRACTOR_0_6_NPS1_RCMDTN_NB,
        $56::FLOAT AS NEUTRAL_7_8_NPS1_RCMDTN_NB,
        $57::FLOAT AS PROMOTER_9_10_NPS1_RCMDTN_NB,
        $58::FLOAT AS NPS_RCMDTN_PC,
        $59::FLOAT AS NPS_AVRG_RCMDTN_NB,
        $60::FLOAT AS YES_VOC3_OFFERED_TST_DRV_NB,
        $61::FLOAT AS NO_VOC3_OFFERED_TST_DRV_NB,
        $62::FLOAT AS TOTL_VOC3_OFFERED_TST_DRV_NB,
        $63::FLOAT AS SCOR_0_VOC4_STSFCN_TST_DRV_NB,
        $64::FLOAT AS SCOR_1_VOC4_STSFCN_TST_DRV_NB,
        $65::FLOAT AS SCOR_2_VOC4_STSFCN_TST_DRV_NB,
        $66::FLOAT AS SCOR_3_VOC4_STSFCN_TST_DRV_NB,
        $67::FLOAT AS SCOR_4_VOC4_STSFCN_TST_DRV_NB,
        $68::FLOAT AS SCOR_5_VOC4_STSFCN_TST_DRV_NB,
        $69::FLOAT AS SCOR_6_VOC4_STSFCN_TST_DRV_NB,
        $70::FLOAT AS SCOR_7_VOC4_STSFCN_TST_DRV_NB,
        $71::FLOAT AS SCOR_8_VOC4_STSFCN_TST_DRV_NB,
        $72::FLOAT AS SCOR_9_VOC4_STSFCN_TST_DRV_NB,
        $73::FLOAT AS SCOR_10_VOC4_STSFCN_TST_DRV_NB,
        $74::FLOAT AS DETRACTOR_0_6_VOC4_STSFCN_TST_DRV_NB,
        $75::FLOAT AS NEUTRAL_7_8_VOC4_STSFCN_TST_DRV_NB,
        $76::FLOAT AS PROMOTER_9_10_VOC4_STSFCN_TST_DRV_NB,
        $77::FLOAT AS TST_DRV_NPS_PC,
        $78::FLOAT AS TST_DRV_AVRG_NB,
        $79::FLOAT AS SCOR_0_VOC5_EXPCTD_PRCHS_PRCS_NB,
        $80::FLOAT AS SCOR_1_VOC5_EXPCTD_PRCHS_PRCS_NB,
        $81::FLOAT AS SCOR_2_VOC5_EXPCTD_PRCHS_PRCS_NB,
        $82::FLOAT AS SCOR_3_VOC5_EXPCTD_PRCHS_PRCS_NB,
        $83::FLOAT AS SCOR_4_VOC5_EXPCTD_PRCHS_PRCS_NB,
        $84::FLOAT AS SCOR_5_VOC5_EXPCTD_PRCHS_PRCS_NB,
        $85::FLOAT AS SCOR_6_VOC5_EXPCTD_PRCHS_PRCS_NB,
        $86::FLOAT AS SCOR_7_VOC5_EXPCTD_PRCHS_PRCS_NB,
        $87::FLOAT AS SCOR_8_VOC5_EXPCTD_PRCHS_PRCS_NB,
        $88::FLOAT AS SCOR_9_VOC5_EXPCTD_PRCHS_PRCS_NB,
        $89::FLOAT AS SCOR_10_VOC5_EXPCTD_PRCHS_PRCS_NB,
        $90::FLOAT AS DETRACTOR_0_6_VOC5_EXPCTD_PRCHS_PRCS_NB,
        $91::FLOAT AS NEUTRAL_7_8_VOC5_EXPCTD_PRCHS_PRCS_NB,
        $92::FLOAT AS PROMOTER_9_10_VOC5_EXPCTD_PRCHS_PRCS_NB,
        $93::FLOAT AS PRCHS_PRCS_EXPCTD_NPS_PC,
        $94::FLOAT AS PRCHS_PRCS_EXPCTD_AVRG_NB,
        $95::FLOAT AS LVL_1_CLSD_TICKETS_NB,
        $96::FLOAT AS LVL_2_CLSD_TICKETS_NB,
        $97::FLOAT AS LVL_3_CLSD_TICKETS_NB,
        $98::FLOAT AS TOTL_CLSD_TICKETS_NB,
        $99::FLOAT AS LVL_1_PC_CLSD_TICKETS_PC,
        $100::FLOAT AS TCKT_OPN_NB,
        $101::FLOAT AS NPS_3RM_STSFCN_PRCHS_EXPRNC_CFCNT_PC,
        $102::FLOAT AS DETRACTOR_0_6_3RM_STSFCN_PRCHS_EXPRNC_CFCNT_NB,
        $103::FLOAT AS NEUTRAL_7_8_3RM_STSFCN_PRCHS_EXPRNC_CFCNT_NB,
        $104::FLOAT AS PROMOTER_9_10_3RM_STSFCN_PRCHS_EXPRNC_CFCNT_NB,
        $105::FLOAT AS NPS_6RM_STSFCN_PRCHS_EXPRNC_CFCNT_PC,
        $106::FLOAT AS DETRACTOR_0_6_6RM_STSFCN_PRCHS_EXPRNC_CFCNT_NB,
        $107::FLOAT AS NEUTRAL_7_8_6RM_STSFCN_PRCHS_EXPRNC_CFCNT_NB,
        $108::FLOAT AS PROMOTER_9_10_6RM_STSFCN_PRCHS_EXPRNC_CFCNT_NB,
        $109::FLOAT AS CFCNT_3RM_STSFCN_PRCHS_EXPRNC_CFCNT_PC,
        $110::FLOAT AS CFCNT_6RM_STSFCN_PRCHS_EXPRNC_CFCNT_PC,
        $111::VARCHAR(250) AS HASHKEY,
        $112::TIMESTAMP AS AUDIT_LOADED_DATE
    FROM '@NMEX_MAP_EXT_STG/validated/JDP/VENTA VOC 3M'
)
FILE_FORMAT = (   
TYPE = 'CSV',   
FIELD_DELIMITER = ';',   
SKIP_HEADER = 1,   
DATE_FORMAT = 'AUTO',   
TIMESTAMP_FORMAT = 'AUTO',   
NULL_IF = ('NULL', '','NaN','nan','NAN'),   
TRIM_SPACE = TRUE)ON_ERROR = 'CONTINUE';
--
select * from VOC_ASMNT_SLS_RLNG_3_MNTH_SG_PIPE;
show pipes;
 
SELECT SYSTEM$PIPE_STATUS('VOC_ASMNT_SLS_RLNG_3_MNTH_SG_PIPE');
ALTER PIPE VOC_ASMNT_SLS_RLNG_3_MNTH_SG_PIPE REFRESH;
SELECT * FROM TABLE (INFORMATION_SCHEMA.COPY_HISTORY('VOC_ASMNT_SLS_RLNG_3_MNTH_SG', START_TIME => DATEADD(hours,-30,CURRENT_TIMESTAMP())));
 